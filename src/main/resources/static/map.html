<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>자전거 보관소 지도</title>
    <link rel="stylesheet" href="/css/map.css">
    <script src="https://maps.googleapis.com/maps/api/js?key=구글맵api"></script>
</head>
<body>

<h2>자전거 보관소 위치</h2>
<div id="map"></div>

<script>
    let map;

    function initMap(callback) {
        // 지도 초기화
        map = new google.maps.Map(document.getElementById("map"), {
            center: {lat: 37.374532, lng: 126.633623}, // 인천대학교 정보기술대학 초기 위치
            zoom: 17,       // 지도 확대 사이즈 (숫자 클 수록 크게 확대됨.)
            gestureHandling: "greedy" // 스크롤으로 확대 축소 (기본값은 cooperative 생략되어있음)
            // none은 둘 다 비활성화, auto는 환경에 따라 자동으로 변환함.
        });

        // 마커 데이터 로딩
        fetch("/api/stations")
            .then(res => res.json())
            .then(data => {
                data.forEach(loc => {
                    const marker = new google.maps.Marker({
                        map: map,
                        position: {lat: loc.lat, lng: loc.lng},
                        title: loc.name
                    });

                    // 구글 지도 상에 있는 빨간 마커 클릭 시, 나타나는 정보들
                    const infoWindow = new google.maps.InfoWindow({
                        content: `<strong>${loc.name}</strong>`
                    });

                    marker.addListener('click', () => {
                        infoWindow.open(map, marker);
                    });
                });
            })
            .catch(error => {
                console.error("API 호출 에러:", error);
            });
    }

    // 구글 지도 로딩 완료 시 자동 실행
    window.onload = initMap;
</script>


</body>
</html>
